syntax = "proto3";
package leapmux.v1;

// SectionService manages per-user sidebar sections.
// Called by Frontend on Hub via ConnectRPC.
service SectionService {
  // List all sections and workspace assignments for the current user.
  // Auto-initializes default sections on first call.
  rpc ListSections(ListSectionsRequest) returns (ListSectionsResponse);
  // Create a new custom section.
  rpc CreateSection(CreateSectionRequest) returns (CreateSectionResponse);
  // Rename a custom section.
  rpc RenameSection(RenameSectionRequest) returns (RenameSectionResponse);
  // Delete a custom section (moves its workspaces to "In progress").
  rpc DeleteSection(DeleteSectionRequest) returns (DeleteSectionResponse);
  // Move a section to a different sidebar and/or position.
  rpc MoveSection(MoveSectionRequest) returns (MoveSectionResponse);
  // Move a workspace to a different section at a given position.
  rpc MoveWorkspace(MoveWorkspaceRequest) returns (MoveWorkspaceResponse);
}

// SectionType distinguishes built-in from user-created sections.
enum SectionType {
  SECTION_TYPE_UNSPECIFIED = 0;
  SECTION_TYPE_WORKSPACES_CUSTOM = 1;
  SECTION_TYPE_WORKSPACES_IN_PROGRESS = 2;
  SECTION_TYPE_WORKSPACES_ARCHIVED = 3;
  SECTION_TYPE_WORKSPACES_SHARED = 4;
  SECTION_TYPE_FILES = 5;
  SECTION_TYPE_TODOS = 6;
}

// Sidebar indicates which sidebar a section belongs to.
enum Sidebar {
  SIDEBAR_UNSPECIFIED = 0;
  SIDEBAR_LEFT = 1;
  SIDEBAR_RIGHT = 2;
}

// Section represents a user's sidebar section.
message Section {
  string id = 1;
  string name = 2;
  string position = 3;
  SectionType section_type = 4;
  Sidebar sidebar = 5;
}

// SectionItem represents a workspace's assignment to a section.
message SectionItem {
  string workspace_id = 1;
  string section_id = 2;
  string position = 3;
}

message ListSectionsRequest {
  string org_id = 1;
}

message ListSectionsResponse {
  repeated Section sections = 1;
  repeated SectionItem items = 2;
}

message CreateSectionRequest {
  string name = 1;
  string org_id = 2;
}

message CreateSectionResponse {
  Section section = 1;
}

message RenameSectionRequest {
  string section_id = 1;
  string name = 2;
}

message RenameSectionResponse {}

message DeleteSectionRequest {
  string section_id = 1;
}

message DeleteSectionResponse {}

message MoveSectionRequest {
  string section_id = 1;
  Sidebar sidebar = 2;
  string position = 3;
}

message MoveSectionResponse {}

message MoveWorkspaceRequest {
  string workspace_id = 1;
  string section_id = 2;
  string position = 3;
}

message MoveWorkspaceResponse {}
